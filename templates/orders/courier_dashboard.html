<!DOCTYPE html>
<html>
<head>
    <title>–ö—É—Ä—å–µ—Ä –ø–∞–Ω–µ–ª—ñ</title>
</head>
<body>
    <h2>–ö—É—Ä—å–µ—Ä –ø–∞–Ω–µ–ª—ñ</h2>

    <!-- üîì –®—ã“ì—É –±–∞—Ç—ã—Ä–º–∞—Å—ã -->
    <form method="post" action="{% url 'logout' %}">
        {% csrf_token %}
        <button type="submit">üîì –ê–∫–∫–∞—É–Ω—Ç—Ç–∞–Ω —à—ã“ì—É</button>
    </form>

    <hr>

    {% if order %}
        <p><strong>”®–Ω—ñ–º:</strong> {{ order.product.name }}</p>
        <p><strong>–ú–µ–∫–µ–Ω–∂–∞–π:</strong> {{ order.address }}</p>
        <form method="post">
            {% csrf_token %}
            <input type="hidden" name="order_id" value="{{ order.id }}">
            <button type="submit" name="mark_delivered">–ñ–µ—Ç–∫—ñ–∑—ñ–ª–¥—ñ</button>
        </form>
    {% else %}
        <form method="post">
            {% csrf_token %}
            <button type="submit" name="go_online">–ù–∞ –ª–∏–Ω–∏—è</button>
        </form>
        <p>“ö–∞–∑—ñ—Ä —Å—ñ–∑–¥–µ —Ç–∞–ø—Å—ã—Ä—ã—Å –∂–æ“õ</p>
    {% endif %}

    <!-- üîä –î—ã–±—ã—Å—Ç—ã“õ —Ö–∞–±–∞—Ä–ª–∞–º–∞ -->
    <audio id="notif-sound" src="/static/sound/new_order.mp3" preload="auto"></audio>

    <script>
        function checkNewOrders() {
            fetch("{% url 'check_new_orders_courier' %}")
                .then(response => response.json())
                .then(data => {
                    if (data.new_order) {
                        document.getElementById('notif-sound').play();
                    }
                });
        }

        setInterval(checkNewOrders, 5000);  // ”ô—Ä 5 —Å–µ–∫ —Å–∞–π—ã–Ω –∂–∞“£–∞ —Ç–∞–ø—Å—ã—Ä—ã—Å—Ç—ã —Ç–µ–∫—Å–µ—Ä–µ–¥—ñ
    </script>
</body>
</html>
